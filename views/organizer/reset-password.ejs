<%
const escapeHtml = (str) => str ? String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;') : '';
const body = `
<div class="form-page login-page">
  <h1>Nouveau mot de passe</h1>

  ${error ? '<div class="alert alert-error">' + escapeHtml(error) + '</div>' : ''}

  <form action="/organizer/reset-password/${token}" method="POST" class="login-form">
    <input type="hidden" name="_csrf" value="${csrfToken}">
    <div class="form-group">
      <label for="password">Nouveau mot de passe</label>
      <input type="password" id="password" name="password" required
             placeholder="8 caracteres minimum" minlength="8" maxlength="72" autofocus>
    </div>
    <div class="form-group">
      <label for="password_confirm">Confirmer le mot de passe</label>
      <input type="password" id="password_confirm" name="password_confirm" required
             placeholder="Confirmez votre mot de passe" minlength="8" maxlength="72">
    </div>
    <button type="submit" class="btn btn-primary">Changer le mot de passe</button>
  </form>

  <p class="back-link"><a href="/organizer/login">Retour a la connexion</a></p>
</div>
` %>
<%- include('../layout', { title, organizer: null, body }) %>
